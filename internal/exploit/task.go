package exploit

import (
	"fmt"
	"time"
)

func NewTask(s *State, teamID string, teamIP string, environ []string, timeout time.Duration) Task {
	return Task{
		name:       s.ID,
		executable: s.Path,
		dir:        s.Dir,
		teamID:     teamID,
		teamIP:     teamIP,
		timeout:    timeout,
		environ:    environ,
	}
}

type Task struct {
	name       string
	executable string
	dir        string
	teamID     string
	teamIP     string
	environ    []string
	timeout    time.Duration
}

func (et Task) String() string {
	return fmt.Sprintf(
		"Exploit(path=%s, target=%s (%s), timeout=%v, environ=%+v)",
		et.executable,
		et.teamID,
		et.teamIP,
		et.timeout,
		et.environ,
	)
}
